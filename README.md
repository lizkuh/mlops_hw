# mlops_hw (hw1, hw2, hw3)
### Кухарева Лиза


### Описание
````md
Что сделала

        Дз1:
        + Все работает, провела серьезный рефакторинг (старый код в папке old)
        + Swagger подтягивает все красиво из docstring:
            http://localhost:8080/redoc
        + Передалала на requirements.txt и взяла другой начальный докер образ

        Дз2:
        + Настроила базу postgres и переписала весь код с использованием ORM
        + Docker для микросервиса
        + Сделала docker compose
          docker compose -f docker_compose.yml up
        + Залила все в dockerhub

        Дз3:
        +  Тесты
        -  Настроить CI/CD
        + Переписала ReadMe
````
#### Что надо было сделать
````md
Дз 1
Реализовать API (REST либо процедуры gRPC), которое умеет:
1. Обучать ML-модель с возможностью настройки
гиперпараметров. При этом гиперпараметры для разных
моделей могут быть разные. Минимальное количество классов
моделей, доступных для обучения == 2.
2. Возвращать список доступных для обучения классов моделей
3. Возвращать предсказание конкретной модели (как следствие,
система должна уметь хранить несколько обученных моделей)
4. Обучать заново и удалять уже обученные модели

Оценка
+• [4 балла] Работоспособность программы - то, что ее можно запустить и
она выполняет задачи, перечисленные в требованиях.
+• [3 балла] Корректность и адекватность программы - корректная
обработка ошибок, адекватный выбор структур классов, понятная
документация (docstring-и адекватные здесь обязательны)
-+• [2 балла] Стиль кода - соблюдение стайлгайда. Буду проверять flake8
(не все ошибки на самом деле являются таковыми, но какие можно
оставить – решать вам, насколько они критичны, списка нет )
+• [1 балл] Swagger – Есть документация API (Swagger) с помощью flask-
restx или аналога
• [2 балла] – Реализация и REST API, и gRPC

Дз 2
К приложению из первого дз нужно добавить:
1. Работу с базой данной Postgresql.
2. Сборку самого вашего микросервиса в docker образ (образ
нужно запушить в docker hub)
3. Запуск вашего сервиса и БД через docker-compose
4. [полуопционально] Запуск вашего сервиса в кубере
5. [на будущее] Написать тесты

Оценка
+• [3 балла] В приложение добавлена работа с БД
-+• [3 балла] Получившееся приложение собрано в Docker-образ, и он
опубликован в DockerHub
-• [3 балла] Приложение можно запустить утилитой docker-compose
• [2 балла] Приложение запускается на Kubernetes (требуется
приложить скрипт поднятия кластера minikube и деплоймент,
либо Mak)

Дз 3
К приложению из второго дз нужно добавить:
1. Unit тесты. Работу с БД/S3 замокать
2. CI пайплайн:
1. Запуск тестов
2. Сборка образа и пуш ее в докерхаб

Оценка
-+• [10 баллов] Есть тесты, они достаточно полные.
• [5 баллов] Есть CI Pipeline, который запускается при Merge
Request-ах

````

#### ORM

````md
База  model_db

Таблицы:

1) model_signature
   правила работы с типами моделей и какие могут быть входные переменные
2) model_instance 
   обученные модели

ORM назодится в database/models.py
````

#### Docker

Создать образ docker
```
sudo docker build . -t mlops_hw
```


Запустить все (docker compose)
```
docker compose -f docker_compose.yml up
```

Образ в dockerhub
```
https://hub.docker.com/repository/docker/lizkuh/lizkuh_mlops_hw
```

#### Тесты

Проверить, что тесты работают

```
docker exec -it fastapi_microservice bash
pytest tests.py
```
